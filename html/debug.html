<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ACQ200 HOSTDRV: Debug Checklist</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ACQ200 HOSTDRV</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Debug Checklist </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>In the event that the installation doesn't work, follow this checklist step by step.</p>
<ol type="1">
<li>Is the card visible on the bus? (example for ACQ196) <div class="fragment"><pre class="fragment">/sbin/lspci | grep 318
09:0d.0 Co-processor: Intel Corporation: Unknown device 0318 (rev 02)
09:0e.0 Co-processor: Intel Corporation: Unknown device 0318 (rev 02)
</pre></div></li>
<li>Did the module load? <div class="fragment"><pre class="fragment">bash-3.00$ grep acq /proc/modules 
acq200_hostdrv 44740 0 - Live 0xf8bfc000
</pre></div></li>
<li>Were the logical device[s] created? <div class="fragment"><pre class="fragment">bash-3.00$ ls -1 /sys/<span class="keyword">class</span>/acqX00
acq200.0
acq200.1

bash-3.00$ grep acq200 /proc/<a class="code" href="acq200_8c.html#a6d0df848ad798ece6b2c8dddfba8049e">devices</a>
252 acq200.1
253 acq200.0
... example shows two ACQ196 <a class="code" href="acq200_8c.html#a6d0df848ad798ece6b2c8dddfba8049e">devices</a> of the <span class="keyword">class </span>acqX00
</pre></div></li>
<li>Can we feel the heartbeat?. <div class="fragment"><pre class="fragment">bash-3.00$ cat /sys/<span class="keyword">class</span>/acqX00/acq200.0/device/heartbeat 
10

... non-zero number means the card is alive
</pre></div></li>
<li>Does the slot mapping correspond to physical CPCI slots? <div class="fragment"><pre class="fragment">bash-3.00$ cat /sys/module/acq200_hostdrv/parameters/<a class="code" href="acq200_8c.html#a1c7287bff61a1b7eacf211d102c306fe">slots</a> 
4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0

in the above example, logical device 
acq200.0 is in CPCI slot 4
acq200.1 is in CPCI slot 3
</pre></div></li>
<li>Did the hotplug script work? <div class="fragment"><pre class="fragment">bash-3.00$ ls -l /dev/acq200/.*rsh
crw-rw-r--  1 root dt100 252, 229 Aug  7 12:35 /dev/acq200/acq200.3.rsh
crw-rw-r--  1 root dt100 253, 229 Aug  7 12:35 /dev/acq200/acq200.4.rsh

<span class="preprocessor"># the rsh device is used by acqcmd -s SLOT</span>
<span class="preprocessor"></span>
bash-3.00$ ls -l /dev/acq32/acq32.?.m?
crw-rw-r--  1 root dt100 252, 237 Aug  7 12:35 /dev/acq32/acq32.3.m3
crw-rw-r--  1 root dt100 253, 237 Aug  7 12:35 /dev/acq32/acq32.4.m4

<span class="preprocessor"># the .m master device is used by acqcmd -b BOARD</span>
<span class="preprocessor"></span>
The major number corresponds to the device number in /proc/<a class="code" href="acq200_8c.html#a6d0df848ad798ece6b2c8dddfba8049e">devices</a>

NB: the hotplug script REQUIRES a user <span class="stringliteral">&#39;dt100&#39;</span> to exist in /etc/group, by convention, <span class="keyword">this</span> is:

bash-3.00$ grep dt100 /etc/group
dt100:x:1001:milne
</pre></div></li>
<li>Were channel data nodes created? <div class="fragment"><pre class="fragment">bash-3.00$ ls /dev/acq32/acq32.?.[0-9][0-9]
/dev/acq32/acq32.3.00  /dev/acq32/acq32.3.54  /dev/acq32/acq32.4.43
/dev/acq32/acq32.3.01  /dev/acq32/acq32.3.55  /dev/acq32/acq32.4.44
/dev/acq32/acq32.3.02  /dev/acq32/acq32.3.56  /dev/acq32/acq32.4.45
</pre></div></li>
<li>Are we able to talk to the card using acqcmd?. <div class="fragment"><pre class="fragment">bash-3.00$ acqcmd -b 3 getFwrev
ACQ32:linux.initrd.extra 73.2029.2393
ACQ216CPCI, WAV232CPCI copyright (c) D-TACQ Solutions Ltd 2003-2006
ACQ200 image built at May 11 2007:18:06:30 Build 2201
$Id: acq200.c,v 1.60 2012/01/18 09:34:25 pgm Exp $
$Revision: 1.60 $

bash-3.00$ acqcmd -s 3 &#39;echo `hostname` `get.release.versions`&#39;
acq196_079 73.2029.2393
EOF 17 0
</pre></div></li>
<li>OK, let's capture some data! <div class="fragment"><pre class="fragment">bash-3.00$ acqcmd -b 3 setInternalClock 250000
ACQ32:
bash-3.00$ acqcmd -b 3 setMode SOFT_TRANSIENT 100000
ACQ32:
bash-3.00$ acqcmd -b 3 setArm
ACQ32:
bash-3.00$ acqcmd -b 3 getState
ACQ32:0 ST_STOP
bash-3.00$ acqcmd -b 3 getNumSamples
ACQ32:getNumSamples=100000 pre=0 post=100000 elapsed=100000
bash-3.00$ dd <span class="keywordflow">if</span>=/dev/acq32/acq32.3.03 bs=1000000 | hexdump | head
0000000 0021 001d 001e 001e 001e 0021 001d 001f
0000010 001e 001d 0021 001c 001d 001e 001d 0022
0000020 001c 001c 001d 001d 0021 001e 001e 001c
0000030 001c 0020 0020 001d 001e 001b 0020 001f
</pre></div> </li>
</ol>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
